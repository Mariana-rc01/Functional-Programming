<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>MultiPlayerTarefa3_2022li1g007</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption empty">&nbsp;</span><ul class="links" id="page-menu"><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th valign="top">Copyright</th><td>Mariana Rocha Cristino &lt;a90817@alunos.uminho.pt&gt;<br />Ana Carolina Penha Cerqueira &lt;a104188@alunos.uminho.pt&gt;</td></tr><tr><th>Safe Haskell</th><td>Safe-Inferred</td></tr></table><p class="caption">MultiPlayerTarefa3_2022li1g007</p></div><div id="description"><p class="caption">Description</p><div class="doc"><p>M&#243;dulo para a realiza&#231;&#227;o da Tarefa 6 do projeto de LI1 em 2022/23.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><a href="#v:animaJogoM">animaJogoM</a> :: <a href="LI12223.html#t:JogoM" title="LI12223">JogoM</a> -&gt; [<a href="LI12223.html#t:Jogada" title="LI12223">Jogada</a>] -&gt; <a href="LI12223.html#t:JogoM" title="LI12223">JogoM</a></li><li class="src short"><a href="#v:moveObstaculoM">moveObstaculoM</a> :: [(<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>])] -&gt; [<a href="LI12223.html#t:Jogada" title="LI12223">Jogada</a>] -&gt; <a href="LI12223.html#t:Jogador" title="LI12223">Jogador</a> -&gt; <a href="LI12223.html#t:Jogador" title="LI12223">Jogador</a> -&gt; [(<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>])]</li><li class="src short"><a href="#v:verificaTerreno">verificaTerreno</a> :: [(<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>])] -&gt; <a href="LI12223.html#t:Jogada" title="LI12223">Jogada</a> -&gt; <a href="LI12223.html#t:Jogador" title="LI12223">Jogador</a> -&gt; (<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>])</li><li class="src short"><a href="#v:moveObstaculoMaux">moveObstaculoMaux</a> :: [(<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>])] -&gt; <a href="LI12223.html#t:Jogada" title="LI12223">Jogada</a> -&gt; <a href="LI12223.html#t:Jogador" title="LI12223">Jogador</a> -&gt; [(<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>])]</li><li class="src short"><a href="#v:animaJogadorTroncoM1">animaJogadorTroncoM1</a> :: <a href="LI12223.html#t:JogoM" title="LI12223">JogoM</a> -&gt; <a href="LI12223.html#t:Jogada" title="LI12223">Jogada</a> -&gt; <a href="LI12223.html#t:JogoM" title="LI12223">JogoM</a></li><li class="src short"><a href="#v:animaJogadorTroncoM2">animaJogadorTroncoM2</a> :: <a href="LI12223.html#t:JogoM" title="LI12223">JogoM</a> -&gt; <a href="LI12223.html#t:Jogada" title="LI12223">Jogada</a> -&gt; <a href="LI12223.html#t:JogoM" title="LI12223">JogoM</a></li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><a id="v:animaJogoM" class="def">animaJogoM</a> <a href="#v:animaJogoM" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="LI12223.html#t:JogoM" title="LI12223">JogoM</a></td><td class="doc"><p>1&#186; argumento: Jogo constitu&#237;do por um jogador e por um mapa</p></td></tr><tr><td class="src">-&gt; [<a href="LI12223.html#t:Jogada" title="LI12223">Jogada</a>]</td><td class="doc"><p>2&#186; argumento: Jogadas efetuadas pelos jogadores respetivamente</p></td></tr><tr><td class="src">-&gt; <a href="LI12223.html#t:JogoM" title="LI12223">JogoM</a></td><td class="doc"><p>resultado: Jogo com o movimento do jogador e dos obst&#225;culos</p></td></tr></table></div><div class="doc"><p>A fun&#231;&#227;o <code><a href="MultiPlayerTarefa3_2022li1g007.html#v:animaJogoM" title="MultiPlayerTarefa3_2022li1g007">animaJogoM</a></code> movimenta os obst&#225;culos (consoante a sua velocidade associada) e as personagens, de acordo com 
as jogadas fornecidas e onde estas se encontram, com o aux&#237;lio das fun&#231;&#245;es <code><a href="MultiPlayerTarefa3_2022li1g007.html#v:moveObstaculoM" title="MultiPlayerTarefa3_2022li1g007">moveObstaculoM</a></code> e <code><a href="Tarefa3_2022li1g007.html#v:moveJogador" title="Tarefa3_2022li1g007">moveJogador</a></code>, respetivamente.</p><p>Assume-se que as personagens se encontram dentro de um mapa v&#225;lido.</p><p>A fun&#231;&#227;o poderia ser definida da seguinte forma:</p><pre>animaJogo :: JogoM -&gt; [Jogada] -&gt; JogoM
animaJogoM (JogoM jogador1 jogador2 mapa@(Mapa l lT)) [jogada1,jogada2] = JogoM (moveJogador jogador1 mapa jogada1) (moveJogador jogador2 mapa jogada2) (Mapa l (moveObstaculoM lT [jogada1,jogada2] jogador1 jogador2))
</pre><h2>Exemplos de utiliza&#231;&#227;o:</h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>animaJogoM (JogoM (Jogador (2,2)) (Jogador (2,1))  (Mapa 4 [(Rio 1,[Nenhum,Tronco,Nenhum,Tronco]),(Relva,[Nenhum,Nenhum,Nenhum,Nenhum]),(Estrada (-1),[Carro,Carro,Nenhum,Nenhum])])) [Parado,Parado]
</code></strong>JogoM (Jogador (2,2)) (Jogador (2,1)) (Mapa 4 [(Rio 1,[Tronco,Nenhum,Tronco,Nenhum]),(Relva,[Nenhum,Nenhum,Nenhum,Nenhum]),(Estrada (-1),[Carro,Nenhum,Nenhum,Carro])])
</pre><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>animaJogoM (JogoM (Jogador (2,2)) (Jogador (2,1))  (Mapa 4 [(Rio 1,[Nenhum,Tronco,Nenhum,Tronco]),(Relva,[Nenhum,Nenhum,Nenhum,Nenhum]),(Estrada (-1),[Carro,Carro,Nenhum,Nenhum])])) [Move Direita,Move Cima]
</code></strong>JogoM (Jogador (3,2)) (Jogador (2,0)) (Mapa 4 [(Rio 1,[Tronco,Nenhum,Tronco,Nenhum]),(Relva,[Nenhum,Nenhum,Nenhum,Nenhum]),(Estrada (-1),[Carro,Nenhum,Nenhum,Carro])])
</pre><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>animaJogoM (JogoM (Jogador (1,0)) (Jogador (2,1))  (Mapa 4 [(Rio 1,[Nenhum,Tronco,Nenhum,Tronco]),(Relva,[Nenhum,Nenhum,Nenhum,Nenhum]),(Estrada (-1),[Carro,Carro,Nenhum,Nenhum])])) [Move Direita,Move Cima]
</code></strong>JogoM (Jogador (3,0)) (Jogador (2,0)) (Mapa 4 [(Rio 1,[Tronco,Nenhum,Tronco,Nenhum]),(Relva,[Nenhum,Nenhum,Nenhum,Nenhum]),(Estrada (-1),[Carro,Nenhum,Nenhum,Carro])])
</pre></div></div><div class="top"><p class="src"><a id="v:moveObstaculoM" class="def">moveObstaculoM</a> <a href="#v:moveObstaculoM" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: [(<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>])]</td><td class="doc"><p>1&#186; argumento: lista de pares de terrenos e lista de obst&#225;culos associada a cada terreno</p></td></tr><tr><td class="src">-&gt; [<a href="LI12223.html#t:Jogada" title="LI12223">Jogada</a>]</td><td class="doc"><p>2&#186; argumento: Jogadas dos Jogadores</p></td></tr><tr><td class="src">-&gt; <a href="LI12223.html#t:Jogador" title="LI12223">Jogador</a></td><td class="doc"><p>3&#186; argumento: 1&#186; Jogador  </p></td></tr><tr><td class="src">-&gt; <a href="LI12223.html#t:Jogador" title="LI12223">Jogador</a></td><td class="doc"><p>4&#186; argumento: 2&#186; Jogador  </p></td></tr><tr><td class="src">-&gt; [(<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>])]</td><td class="doc"><p>resultado: lista de pares de terrenos e lista de obst&#225;culos movidos consoante a velocidade associada</p></td></tr></table></div><div class="doc"><p>A fun&#231;&#227;o <code><a href="MultiPlayerTarefa3_2022li1g007.html#v:moveObstaculoM" title="MultiPlayerTarefa3_2022li1g007">moveObstaculoM</a></code> tem como objetivo mover os obst&#225;culos consoante a velocidade associada.</p><p>Desta forma, caso nos encontremos na <strong>Relva</strong>, os obst&#225;culos mant&#234;m-se na mesma posi&#231;&#227;o, caso se encontrem na <strong>Estrada</strong> ou no <strong>Rio</strong>,
os obst&#225;culos movem-se.</p><p>&#201; tamb&#233;m necess&#225;rio ter em aten&#231;&#227;o caso os Jogadores se encontrem ou se deslocem para uma Estrada, pois estes podem ser atropelados tendo em conta o movimento do mesmo.
De modo que, averigua-se quais os movimentos dos Jogadores e caso estes se movam para Cima ou para Baixo, verifica-se se o terreno para onde estes se movem &#233; uma Estrada.
Caso contr&#225;rio, verifica-se se os Jogadores se encontram numa Estrada.</p><p>Caso os Jogadores n&#227;o se encontrem numa Estrada, ent&#227;o todos os obst&#225;culos se ir&#227;o mover sem qualquer restri&#231;&#227;o com o aux&#237;lio da fun&#231;&#227;o <code><a href="Tarefa3_2022li1g007.html#v:moveObstaculoAux" title="Tarefa3_2022li1g007">moveObstaculoAux</a></code>.</p><p>Caso um dos Jogadores se encontrem ou se deslocem para uma Estrada, esta tem os obst&#225;culos a serem movidos com o aux&#237;lio da fun&#231;&#227;o <code><a href="Tarefa3_2022li1g007.html#v:moveEstrada" title="Tarefa3_2022li1g007">moveEstrada</a></code> em fun&#231;&#227;o desse Jogador.
Os restantes terrenos t&#234;m os seus obst&#225;culos a moverem-se sem qualquer restri&#231;&#227;o, movendo-se com o aux&#237;lio da fun&#231;&#227;o <code><a href="Tarefa3_2022li1g007.html#v:moveObstaculoAux" title="Tarefa3_2022li1g007">moveObstaculoAux</a></code>.</p><p>Caso ambos os Jogadores se encontrem ou se deslocem para uma Estrada, uma das Estradas ser&#225; movida com o aux&#237;lio da fun&#231;&#227;o <code><a href="MultiPlayerTarefa3_2022li1g007.html#v:moveObstaculoMaux" title="MultiPlayerTarefa3_2022li1g007">moveObstaculoMaux</a></code> (tendo em conta o movimento de um dos Jogadores) e os restantes terrenos com a fun&#231;&#227;o
<code><a href="Tarefa3_2022li1g007.html#v:moveObstaculo" title="Tarefa3_2022li1g007">moveObstaculo</a></code> onde ser&#225; movida tamb&#233;m a outra Estrada (tendo em conta o movimento do outro Jogador).</p><p>A fun&#231;&#227;o poderia ser definida da seguinte forma:</p><pre>moveObstaculoM :: [(Terreno,[Obstaculo])] -&gt; [Jogada] -&gt; Jogador -&gt; Jogador -&gt; [(Terreno,[Obstaculo])]
moveObstaculoM lT [jogada1,jogada2] jogador1 jogador2 | passaString verifica1 == <a href="Estrada.html">Estrada</a> &amp;&amp; passaString verifica2 /= <a href="Estrada.html">Estrada</a> = moveObstaculo lT jogada1 jogador1
                                                      | passaString verifica1 /= <a href="Estrada.html">Estrada</a> &amp;&amp; passaString verifica2 == <a href="Estrada.html">Estrada</a> = moveObstaculo lT jogada2 jogador2
                                                      | passaString verifica1 == <a href="Estrada.html">Estrada</a> &amp;&amp; passaString verifica2 == <a href="Estrada.html">Estrada</a> = moveObstaculoMaux (moveObstaculo lT jogada1 jogador1) jogada2 jogador2
                                                      | otherwise = moveObstaculoAux lT
                                                      where verifica1 = fst $ verificaTerreno lT jogada1 jogador1
                                                            verifica2 = fst $ verificaTerreno lT jogada2 jogador2
                                                            passaString :: Terreno -&gt; String
                                                            passaString t = case t of Estrada _ -&gt; <a href="Estrada.html">Estrada</a>
                                                                                      Rio _     -&gt; <a href="Rio.html">Rio</a>    
                                                                                      Relva     -&gt; <a href="Relva.html">Relva</a>
</pre><h2>Exemplos de utiliza&#231;&#227;o:</h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>moveObstaculoM [(Rio 1,[Nenhum,Tronco,Nenhum,Tronco]),(Relva,[Nenhum,Nenhum,Nenhum,Nenhum]),(Estrada 2,[Carro,Carro,Nenhum,Nenhum])] [Move Direita,Parado] (Jogador (1,0)) (Jogador (2,2))
</code></strong>[(Rio 1,[Tronco,Nenhum,Tronco,Nenhum]),(Relva,[Nenhum,Nenhum,Nenhum,Nenhum]),(Estrada 2,[Nenhum,Carro,Carro,Nenhum])]
</pre><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>moveObstaculoM [(Rio 1,[Nenhum,Tronco,Nenhum,Tronco]),(Relva,[Nenhum,Nenhum,Nenhum,Nenhum]),(Estrada 3,[Carro,Carro,Nenhum,Nenhum])] [Move Direita,Move Esquerda] (Jogador (1,0)) (Jogador (2,2))
</code></strong>[(Rio 1,[Tronco,Nenhum,Tronco,Nenhum]),(Relva,[Nenhum,Nenhum,Nenhum,Nenhum]),(Estrada 3,[Carro,Carro,Nenhum,Nenhum])]
</pre><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>moveObstaculoM [(Rio 1,[Nenhum,Tronco,Nenhum,Tronco]),(Relva,[Nenhum,Nenhum,Nenhum,Nenhum]),(Estrada 3,[Carro,Carro,Nenhum,Nenhum]),(Estrada 2,[Nenhum,Carro,Carro,Nenhum])] [Parado,Move Esquerda] (Jogador (3,3)) (Jogador (2,2))
</code></strong>[(Rio 1,[Tronco,Nenhum,Tronco,Nenhum]),(Relva,[Nenhum,Nenhum,Nenhum,Nenhum]),(Estrada 3,[Carro,Carro,Nenhum,Nenhum]),(Estrada 2,[Nenhum,Nenhum,Carro,Carro])]
</pre></div></div><div class="top"><p class="src"><a id="v:verificaTerreno" class="def">verificaTerreno</a> <a href="#v:verificaTerreno" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: [(<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>])]</td><td class="doc"><p>1&#186; argumento: lista de pares de terrenos e lista de obst&#225;culos associada a cada terreno</p></td></tr><tr><td class="src">-&gt; <a href="LI12223.html#t:Jogada" title="LI12223">Jogada</a></td><td class="doc"><p>2&#186; argumento: Jogada do Jogador</p></td></tr><tr><td class="src">-&gt; <a href="LI12223.html#t:Jogador" title="LI12223">Jogador</a></td><td class="doc"><p>3&#186; argumento: Jogador</p></td></tr><tr><td class="src">-&gt; (<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>])</td><td class="doc"><p>resultado: O par de terreno e lista de obst&#225;culos em que o Jogador se encontra ou se vai deslocar</p></td></tr></table></div><div class="doc"><p>A fun&#231;&#227;o <code><a href="MultiPlayerTarefa3_2022li1g007.html#v:verificaTerreno" title="MultiPlayerTarefa3_2022li1g007">verificaTerreno</a></code> tem como objetivo verificar em que Terreno o Jogador se encontra ou se desloca tendo em conta o seu movimento.</p><p>A fun&#231;&#227;o poderia ser definida da seguinte forma:</p><pre>verificaTerreno :: [(Terreno,[Obstaculo])] -&gt; Jogada -&gt; Jogador -&gt; (Terreno,[Obstaculo])
verificaTerreno lT m (Jogador (x,y)) | m == Move Cima     = lT !! (y-1)
                                     | m == Move Baixo    = lT !! (y+1)
                                     | otherwise          = lT !! y
</pre><h2>Exemplos de utiliza&#231;&#227;o:</h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>verificaTerreno [(Rio 1,[Nenhum,Tronco,Nenhum,Tronco]),(Relva,[Nenhum,Nenhum,Nenhum,Nenhum]),(Estrada 3,[Carro,Carro,Nenhum,Nenhum]),(Estrada 2,[Nenhum,Carro,Carro,Nenhum])] (Move Esquerda) (Jogador (2,2))
</code></strong>(Estrada 3,[Carro,Carro,Nenhum,Nenhum])
</pre><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>verificaTerreno [(Rio 1,[Nenhum,Tronco,Nenhum,Tronco]),(Relva,[Nenhum,Nenhum,Nenhum,Nenhum]),(Estrada 3,[Carro,Carro,Nenhum,Nenhum]),(Estrada 2,[Nenhum,Carro,Carro,Nenhum])] (Move Cima) (Jogador (2,2))
</code></strong>(Relva,[Nenhum,Nenhum,Nenhum,Nenhum])
</pre></div></div><div class="top"><p class="src"><a id="v:moveObstaculoMaux" class="def">moveObstaculoMaux</a> <a href="#v:moveObstaculoMaux" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: [(<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>])]</td><td class="doc"><p>1&#186; argumento: lista de pares de terrenos e lista de obst&#225;culos associada a cada terreno</p></td></tr><tr><td class="src">-&gt; <a href="LI12223.html#t:Jogada" title="LI12223">Jogada</a></td><td class="doc"><p>2&#186; argumento: Jogada do Jogador</p></td></tr><tr><td class="src">-&gt; <a href="LI12223.html#t:Jogador" title="LI12223">Jogador</a></td><td class="doc"><p>3&#186; argumento: Jogador</p></td></tr><tr><td class="src">-&gt; [(<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>])]</td><td class="doc"><p>resultado: lista de pares de terrenos e lista de obst&#225;culos movidos consoante a velocidade associada</p></td></tr></table></div><div class="doc"><p>A fun&#231;&#227;o <code><a href="MultiPlayerTarefa3_2022li1g007.html#v:moveObstaculoMaux" title="MultiPlayerTarefa3_2022li1g007">moveObstaculoMaux</a></code> tem como objetivo mover a Estrada em que um Jogador se encontra, n&#227;o movendo os restantes terrenos.</p><p>Sabendo &#224; priori que o Jogador se encontra ou se vai deslocar para uma Estrada.</p><p>Para ser poss&#237;vel mover em separado os obst&#225;culos da Estrada que o Jogador se localiza, &#233; usada a fun&#231;&#227;o splitAt, onde esta separa os terrenos, de modo que o &#250;ltimo Terreno da
primeira parte do tuplo seja onde o Jogador se encontra, os restantes elementos da primeira parte do tuplo s&#227;o os Terrenos que se encontram &#224; frente do Jogador e a segunda parte do tuplo s&#227;o
os Terrenos que se encontram atr&#225;s do Jogador.</p><p>A fun&#231;&#227;o poderia ser definida da seguinte forma:</p><pre>moveObstaculoMaux :: [(Terreno,[Obstaculo])] -&gt; Jogada -&gt; Jogador -&gt; [(Terreno,[Obstaculo])]
moveObstaculoMaux lT m (Jogador (x,y)) 
        | m == Move Direita  = (frente $ splitAt (y+1) lT) ++ [(Estrada v, moveEstrada (jogador $ splitAt (y+1) lT) v (x+1))]  ++ (tras $ splitAt (y+1) lT)

        | m == Move Esquerda = (frente $ splitAt (y+1) lT) ++ [(Estrada v, moveEstrada (jogador $ splitAt (y+1) lT) v (x-1))]  ++ (tras $ splitAt (y+1) lT)

        | m == Move Cima     = (frente $ splitAt y lT)     ++ [(Estrada vCima , moveEstrada (jogador $ splitAt y lT) vCima x)] ++ (tras $ splitAt y lT)

        | m == Move Baixo    = (frente $ splitAt (y+2) lT) ++ [(Estrada vBaixo, moveEstrada (jogador $ splitAt (y+2) lT) vBaixo x)] ++ (tras $ splitAt (y+2) lT)

        | m == Parado        = (frente $ splitAt (y+1) lT) ++ [(Estrada v, moveEstrada (jogador $ splitAt (y+1) lT) v x)] ++ (tras $ splitAt (y+1) lT)
     where v = velocidade (fst(lT !! y))
           vCima = velocidade (fst (lT !! (y-1)))
           vBaixo = velocidade (fst (lT !! (y+1)))
           velocidade (Estrada x)  = x
           passaString :: Terreno -&gt; String
           passaString t = case t of Estrada _ -&gt; <a href="Estrada.html">Estrada</a>
                                     Rio _     -&gt; <a href="Rio.html">Rio</a>    
                                     Relva     -&gt; <a href="Relva.html">Relva</a> 
           frente x  = init $ fst x
           tras x    = snd x
           jogador x = snd $ last $ fst x
</pre><h2>Exemplos de utiliza&#231;&#227;o:</h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>moveObstaculoMaux [(Rio 1,[Nenhum,Tronco,Nenhum,Tronco]),(Relva,[Nenhum,Nenhum,Nenhum,Nenhum]),(Estrada 3,[Carro,Carro,Nenhum,Nenhum]),(Estrada 2,[Nenhum,Carro,Carro,Nenhum])] (Move Esquerda) (Jogador (2,2))
</code></strong>[(Rio 1,[Nenhum,Tronco,Nenhum,Tronco]),(Relva,[Nenhum,Nenhum,Nenhum,Nenhum]),(Estrada 3,[Carro,Carro,Nenhum,Nenhum]),(Estrada 2,[Nenhum,Carro,Carro,Nenhum])]
</pre><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>moveObstaculoMaux [(Rio 1,[Nenhum,Tronco,Nenhum,Tronco]),(Relva,[Nenhum,Nenhum,Nenhum,Nenhum]),(Estrada 3,[Carro,Carro,Nenhum,Nenhum]),(Estrada 2,[Nenhum,Carro,Carro,Nenhum])] (Move Baixo) (Jogador (3,2))
</code></strong>[(Rio 1,[Nenhum,Tronco,Nenhum,Tronco]),(Relva,[Nenhum,Nenhum,Nenhum,Nenhum]),(Estrada 3,[Carro,Carro,Nenhum,Nenhum]),(Estrada 2,[Nenhum,Nenhum,Carro,Carro])]
</pre></div></div><div class="top"><p class="src"><a id="v:animaJogadorTroncoM1" class="def">animaJogadorTroncoM1</a> <a href="#v:animaJogadorTroncoM1" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="LI12223.html#t:JogoM" title="LI12223">JogoM</a></td><td class="doc"><p>1&#186; argumento: Jogo constitu&#237;do por um jogador e por um mapa</p></td></tr><tr><td class="src">-&gt; <a href="LI12223.html#t:Jogada" title="LI12223">Jogada</a></td><td class="doc"><p>2&#186; argumento: Jogada efetuada</p></td></tr><tr><td class="src">-&gt; <a href="LI12223.html#t:JogoM" title="LI12223">JogoM</a></td><td class="doc"><p>resultado: Jogo com o movimento do jogador e dos obst&#225;culos</p></td></tr></table></div><div class="doc"><p>A fun&#231;&#227;o <code><a href="MultiPlayerTarefa3_2022li1g007.html#v:animaJogadorTroncoM1" title="MultiPlayerTarefa3_2022li1g007">animaJogadorTroncoM1</a></code> move a primeira personagem, de acordo com 
a jogada fornecida e onde a personagem se encontra, com o aux&#237;lio da fun&#231;&#227;o <code><a href="Tarefa3_2022li1g007.html#v:moveJogador" title="Tarefa3_2022li1g007">moveJogador</a></code> e, 
caso o jogador se encontre num rio, move apenas os Troncos desse rio, com o aux&#237;lio da fun&#231;&#227;o <code><a href="Tarefa3_2022li1g007.html#v:moveTronco" title="Tarefa3_2022li1g007">moveTronco</a></code>.</p><p>Assume-se que a personagem se encontra dentro de um mapa v&#225;lido.</p><p>A fun&#231;&#227;o poderia ser definida da seguinte forma:</p><pre>animaJogadorTroncoM1 :: JogoM -&gt; Jogada -&gt; JogoM
animaJogadorTroncoM1 (JogoM jogador1 jogador2 mapa@(Mapa l lT)) jogada1 = JogoM (moveJogador jogador1 mapa jogada1) jogador2 (Mapa l (moveTronco lT jogador1))
</pre><h2>Exemplos de utiliza&#231;&#227;o:</h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>animaJogadorTroncoM1 (JogoM (Jogador (2,2)) (Jogador (2,1))  (Mapa 4 [(Rio 1,[Nenhum,Tronco,Nenhum,Tronco]),(Relva,[Nenhum,Nenhum,Nenhum,Nenhum]),(Estrada (-1),[Carro,Carro,Nenhum,Nenhum])])) (Move Cima)
</code></strong>JogoM (Jogador (2,1)) (Jogador (2,1)) (Mapa 4 [(Rio 1,[Nenhum,Tronco,Nenhum,Tronco]),(Relva,[Nenhum,Nenhum,Nenhum,Nenhum]),(Estrada (-1),[Carro,Carro,Nenhum,Nenhum])])
</pre><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>animaJogadorTroncoM1 (JogoM (Jogador (1,0)) (Jogador (2,1))  (Mapa 4 [(Rio 1,[Nenhum,Tronco,Nenhum,Tronco]),(Relva,[Nenhum,Nenhum,Nenhum,Nenhum]),(Estrada (-1),[Carro,Carro,Nenhum,Nenhum])])) Parado
</code></strong>JogoM (Jogador (2,0)) (Jogador (2,1)) (Mapa 4 [(Rio 1,[Tronco,Nenhum,Tronco,Nenhum]),(Relva,[Nenhum,Nenhum,Nenhum,Nenhum]),(Estrada (-1),[Carro,Carro,Nenhum,Nenhum])])
</pre></div></div><div class="top"><p class="src"><a id="v:animaJogadorTroncoM2" class="def">animaJogadorTroncoM2</a> <a href="#v:animaJogadorTroncoM2" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="LI12223.html#t:JogoM" title="LI12223">JogoM</a></td><td class="doc"><p>1&#186; argumento: Jogo constitu&#237;do por um jogador e por um mapa</p></td></tr><tr><td class="src">-&gt; <a href="LI12223.html#t:Jogada" title="LI12223">Jogada</a></td><td class="doc"><p>2&#186; argumento: Jogada efetuada</p></td></tr><tr><td class="src">-&gt; <a href="LI12223.html#t:JogoM" title="LI12223">JogoM</a></td><td class="doc"><p>resultado: Jogo com o movimento do jogador e dos obst&#225;culos</p></td></tr></table></div><div class="doc"><p>A fun&#231;&#227;o <code><a href="MultiPlayerTarefa3_2022li1g007.html#v:animaJogadorTroncoM2" title="MultiPlayerTarefa3_2022li1g007">animaJogadorTroncoM2</a></code> move a segunda personagem, de acordo com 
a jogada fornecida e onde a personagem se encontra, com o aux&#237;lio da fun&#231;&#227;o <code><a href="Tarefa3_2022li1g007.html#v:moveJogador" title="Tarefa3_2022li1g007">moveJogador</a></code> e, 
caso o jogador se encontre num rio, move apenas os Troncos desse rio, com o aux&#237;lio da fun&#231;&#227;o <code><a href="Tarefa3_2022li1g007.html#v:moveTronco" title="Tarefa3_2022li1g007">moveTronco</a></code>.</p><p>Assume-se que a personagem se encontra dentro de um mapa v&#225;lido.</p><p>A fun&#231;&#227;o poderia ser definida da seguinte forma:</p><pre>animaJogadorTroncoM2 :: JogoM -&gt; Jogada -&gt; JogoM
animaJogadorTroncoM2 (JogoM jogador1 jogador2 mapa@(Mapa l lT)) jogada2 = JogoM jogador1 (moveJogador jogador2 mapa jogada2) (Mapa l (moveTronco lT jogador2))
</pre><h2>Exemplos de utiliza&#231;&#227;o:</h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>animaJogadorTroncoM2 (JogoM (Jogador (1,1)) (Jogador (1,0))  (Mapa 4 [(Rio 1,[Nenhum,Tronco,Nenhum,Tronco]),(Relva,[Nenhum,Nenhum,Nenhum,Nenhum]),(Estrada (-1),[Carro,Carro,Nenhum,Nenhum])])) Parado
</code></strong>JogoM (Jogador (1,1)) (Jogador (2,0)) (Mapa 4 [(Rio 1,[Tronco,Nenhum,Tronco,Nenhum]),(Relva,[Nenhum,Nenhum,Nenhum,Nenhum]),(Estrada (-1),[Carro,Carro,Nenhum,Nenhum])])
</pre><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>animaJogadorTroncoM2 (JogoM (Jogador (1,1)) (Jogador (1,0))  (Mapa 4 [(Rio 1,[Nenhum,Tronco,Nenhum,Tronco]),(Relva,[Nenhum,Nenhum,Nenhum,Nenhum]),(Estrada (-1),[Carro,Carro,Nenhum,Nenhum])])) (Move Baixo)
</code></strong>JogoM (Jogador (1,1)) (Jogador (1,1)) (Mapa 4 [(Rio 1,[Tronco,Nenhum,Tronco,Nenhum]),(Relva,[Nenhum,Nenhum,Nenhum,Nenhum]),(Estrada (-1),[Carro,Carro,Nenhum,Nenhum])])
</pre></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.26.0</p></div></body></html>