<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Tarefa2_2022li1g007</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption empty">&nbsp;</span><ul class="links" id="page-menu"><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th valign="top">Copyright</th><td>Mariana Rocha Cristino &lt;a90817@alunos.uminho.pt&gt;<br />Ana Carolina Penha Cerqueira &lt;a104188@alunos.uminho.pt&gt;</td></tr><tr><th>Safe Haskell</th><td>Safe-Inferred</td></tr></table><p class="caption">Tarefa2_2022li1g007</p></div><div id="description"><p class="caption">Description</p><div class="doc"><p>M&#243;dulo para a realiza&#231;&#227;o da Tarefa 2 do projeto de LI1 em 2022/23.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><a href="#v:estendeMapa">estendeMapa</a> :: <a href="LI12223.html#t:Mapa" title="LI12223">Mapa</a> -&gt; Int -&gt; <a href="LI12223.html#t:Mapa" title="LI12223">Mapa</a></li><li class="src short"><a href="#v:determinaVelocidadeRio">determinaVelocidadeRio</a> :: Int -&gt; Int -&gt; Int -&gt; Int</li><li class="src short"><a href="#v:determinaVelocidade">determinaVelocidade</a> :: Int -&gt; Int -&gt; Int</li><li class="src short"><a href="#v:proxObs">proxObs</a> :: StdGen -&gt; Int -&gt; (<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]) -&gt; [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]</li><li class="src short"><a href="#v:replace">replace</a> :: <a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a> -&gt; [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>] -&gt; [Int] -&gt; [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]</li><li class="src short"><a href="#v:proximasArvores">proximasArvores</a> :: StdGen -&gt; [(<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>])] -&gt; [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]</li><li class="src short"><a href="#v:proximosTerrenosValidos">proximosTerrenosValidos</a> :: <a href="LI12223.html#t:Mapa" title="LI12223">Mapa</a> -&gt; [<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>]</li><li class="src short"><a href="#v:proximosObstaculosValidos">proximosObstaculosValidos</a> :: Int -&gt; (<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]) -&gt; [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]</li><li class="src short"><a href="#v:auxObstaculosValidos">auxObstaculosValidos</a> :: Int -&gt; (<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]) -&gt; [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]</li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><a id="v:estendeMapa" class="def">estendeMapa</a> <a href="#v:estendeMapa" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="LI12223.html#t:Mapa" title="LI12223">Mapa</a></td><td class="doc"><p>1&#186; argumento: um mapa</p></td></tr><tr><td class="src">-&gt; Int</td><td class="doc"><p>2&#186; argumento: n&#250;mero inteiro entre 0 e 100 (seed)</p></td></tr><tr><td class="src">-&gt; <a href="LI12223.html#t:Mapa" title="LI12223">Mapa</a></td><td class="doc"><p>resultado: o mapa fornecido com a linha gerada                                                   </p></td></tr></table></div><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2022li1g007.html#v:estendeMapa" title="Tarefa2_2022li1g007">estendeMapa</a></code> <strong>gere</strong> e <strong>adiciona</strong> <strong>uma</strong> <strong>nova</strong> <strong>linha</strong> <strong>v&#225;lida</strong> ao topo do mapa dado. Para tal, a fun&#231;&#227;o recebe um mapa v&#225;lido e um inteiro.
O par&#226;metro do tipo <strong>Int</strong> &#233; um inteiro aleat&#243;rio (no intervalo [0,100]) que concede alguma pseudo-aleatoriedade &#224; gera&#231;&#227;o da nova linha.</p><p>A <code><a href="Tarefa2_2022li1g007.html#v:estendeMapa" title="Tarefa2_2022li1g007">estendeMapa</a></code> verifica quais os terrenos pass&#237;veis de serem usados na nova linha do mapa e escolhe um terreno com o aux&#237;lio da seed (inteiro recebido).</p><p>Para definir velocidade para o terreno gerado, seguimos um racioc&#237;nio similar ao usado para o terreno gerado, com o aux&#237;lio da fun&#231;&#227;o <code><a href="Tarefa2_2022li1g007.html#v:determinaVelocidade" title="Tarefa2_2022li1g007">determinaVelocidade</a></code>.
Caso o terreno gerado seja Rela&#171;va, n&#227;o lhe &#233; atribu&#237;da velocidade.</p><p>Com o aux&#237;lio da fun&#231;&#227;o <code><a href="Tarefa2_2022li1g007.html#v:proxObs" title="Tarefa2_2022li1g007">proxObs</a></code> e <code><a href="Tarefa2_2022li1g007.html#v:proximasArvores" title="Tarefa2_2022li1g007">proximasArvores</a></code>, a fun&#231;&#227;o <code><a href="Tarefa2_2022li1g007.html#v:estendeMapa" title="Tarefa2_2022li1g007">estendeMapa</a></code> gera uma linha de obst&#225;culos pass&#237;veis de serem usados na linha gerada. </p><p>A fun&#231;&#227;o poderia ser definida da seguinte forma:</p><pre>estendeMapa :: Mapa -&gt; Int -&gt; Mapa
estendeMapa mapa<code>(Mapa l lT</code>((ter,obst):ts)) seed  | terreno == Relva &amp;&amp; ter == Relva                = Mapa l ((Relva, arvores):lT)
                                                   | terreno == Relva                                = Mapa l ((Relva, obstaculos):lT)
                                                   | terreno == Rio 0 &amp;&amp; (fst $ string ter) == <a href="Rio.html">Rio</a> = Mapa l ((Rio vR, obstaculos):lT)
                                                   | terreno == Rio 0                                = Mapa l ((Rio v, obstaculos):lT)
                                                   | terreno == Estrada 0                            = Mapa l ((Estrada v, obstaculos):lT)
  where terreno    = terrenos !! (mod seed (length terrenos))
        terrenos   = proximosTerrenosValidos mapa
        v          = determinaVelocidade l seed
        vR         = determinaVelocidadeRio (snd $ string ter) l seed
        obstaculos = proxObs (mkStdGen seed) l (terreno, [])
        arvores    = proximasArvores (mkStdGen seed) [(terreno,obstaculos),(ter,obst)]
        string terreno = case terreno of Rio v     -&gt; (<a href="Rio.html">Rio</a>,v)
                                         Estrada v -&gt; (<a href="Estrada.html">Estrada</a>,v)
                                         Relva     -&gt; (<a href="Relva.html">Relva</a>,0)  
</pre><h2>Exemplos de utiliza&#231;&#227;o:</h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>estendeMapa (Mapa 2 [(Rio 2, [Nenhum,Tronco]),(Rio (-2),[Tronco,Nenhum]),(Rio 1, [Tronco,Nenhum]),(Rio (-2),[Tronco,Nenhum])]) 75
</code></strong>Mapa 2 [(Relva,[Arvore,Nenhum]),(Rio 2,[Nenhum,Tronco]),(Rio (-2),[Tronco,Nenhum]),(Rio 1,[Tronco,Nenhum]),(Rio (-2),[Tronco,Nenhum])]
</pre><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>estendeMapa (Mapa 3 [(Estrada 1,[Carro,Carro,Nenhum]),(Estrada 1,[Carro,Carro,Nenhum]),(Estrada 1,[Carro,Carro,Nenhum]),(Rio (-2), [Nenhum,Tronco,Tronco])]) 0
</code></strong>Mapa 3 [(Rio (-1),[Nenhum,Tronco,Nenhum]),(Estrada 1,[Carro,Carro,Nenhum]),(Estrada 1,[Carro,Carro,Nenhum]),(Estrada 1,[Carro,Carro,Nenhum]),(Rio (-2),[Nenhum,Tronco,Tronco])]
</pre></div></div><div class="top"><p class="src"><a id="v:determinaVelocidadeRio" class="def">determinaVelocidadeRio</a> <a href="#v:determinaVelocidadeRio" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: Int</td><td class="doc"><p>1&#186; argumento: velocidade do <strong>Rio</strong> anterior</p></td></tr><tr><td class="src">-&gt; Int</td><td class="doc"><p>2&#186; argumento: largura do mapa</p></td></tr><tr><td class="src">-&gt; Int</td><td class="doc"><p>3&#186; argumento: n&#250;mero aleat&#243;rio entre 0 e 100</p></td></tr><tr><td class="src">-&gt; Int</td><td class="doc"><p>resultado: velocidade</p></td></tr></table></div><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2022li1g007.html#v:determinaVelocidadeRio" title="Tarefa2_2022li1g007">determinaVelocidadeRio</a></code> atribui uma <strong>velocidade</strong> aos <strong>Rios</strong>, caso haja um <strong>Rio</strong> a anteceder, tendo em conta que se a largura do mapa for inferior a 3, 
conferindo uma velocidade entre -1 e 1, caso contr&#225;rio concede uma velocidade entre -3 e 3. </p><p>Esta fun&#231;&#227;o n&#227;o atribui velocidades nulas.</p><p>A fun&#231;&#227;o poderia ser definida da seguinte forma:</p><pre>determinaVelocidadeRio :: Int -&gt; Int -&gt; Int -&gt; Int
determinaVelocidadeRio v l seed | v &gt; 0  = -1
                                | v &lt; 0  =  1
</pre><h2>Exemplos de utiliza&#231;&#227;o:</h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>determinaVelocidade 2 4 1
</code></strong>-1
</pre><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>determinaVelocidade (-2) 2 40
</code></strong>1
</pre></div></div><div class="top"><p class="src"><a id="v:determinaVelocidade" class="def">determinaVelocidade</a> <a href="#v:determinaVelocidade" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: Int</td><td class="doc"><p>1&#186; argumento: largura do mapa</p></td></tr><tr><td class="src">-&gt; Int</td><td class="doc"><p>2&#186; argumento: n&#250;mero aleat&#243;rio entre 0 e 100</p></td></tr><tr><td class="src">-&gt; Int</td><td class="doc"><p>resultado: velocidade</p></td></tr></table></div><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2022li1g007.html#v:determinaVelocidade" title="Tarefa2_2022li1g007">determinaVelocidade</a></code> atribui uma <strong>velocidade</strong>, tendo em conta que se a largura do mapa for inferior a 3, 
conferindo uma velocidade entre -1 e 1, caso contr&#225;rio concede uma velocidade entre -3 e 3.</p><p>Esta fun&#231;&#227;o n&#227;o atribui velocidades nulas.</p><p>A fun&#231;&#227;o poderia ser definida da seguinte forma:</p><pre>determinaVelocidade :: Int -&gt; Int -&gt; Int
determinaVelocidade l seed | l &lt; 3     = (delete 0 [-1..1]) !! (mod (head(geraAleatorios seed 2)) 2)
                           | otherwise = (delete 0 [-3..3]) !! (mod (head(geraAleatorios seed 6)) 6)
                           where geraAleatorios :: Int -&gt; Int -&gt; [Int]
                                 geraAleatorios s c = take c $ randoms (mkStdGen s)
</pre><h2>Exemplos de utiliza&#231;&#227;o:</h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>determinaVelocidade 3 0
</code></strong>-1
</pre><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>determinaVelocidade 2 75
</code></strong>1
</pre></div></div><div class="top"><p class="src"><a id="v:proxObs" class="def">proxObs</a> <a href="#v:proxObs" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: StdGen</td><td class="doc"><p>1&#186; argumento: n&#250;mero aleat&#243;rio</p></td></tr><tr><td class="src">-&gt; Int</td><td class="doc"><p>2&#186; argumento: largura do mapa</p></td></tr><tr><td class="src">-&gt; (<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>])</td><td class="doc"><p>3&#186; argumento: par do terreno gerado e lista de obstaculos que o constitui</p></td></tr><tr><td class="src">-&gt; [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]</td><td class="doc"><p>resultado: lista de obstaculos do terreno gerado com tamanho igual &#224; largura do mapa</p></td></tr></table></div><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2022li1g007.html#v:proxObs" title="Tarefa2_2022li1g007">proxObs</a></code> tem como objetivo gerar uma lista de obst&#225;culos para um terreno de forma que o 
tamanho dessa lista n&#227;o seja superior &#224; largura do mapa.</p><p>Desta forma, a fun&#231;&#227;o verifica quais os obst&#225;culos pass&#237;veis de serem usados no par <strong>(Terreno,[obst&#225;culos])</strong> e adiciona &#224; lista de obst&#225;culos
um deles numa forma aleat&#243;ria.</p><p>Quando a lista de obst&#225;culos tiver um tamanho igual &#224; largura do mapa, a fun&#231;&#227;o devolve a lista dos obst&#225;culos.</p><p>A fun&#231;&#227;o poderia ser definida da seguinte forma:</p><pre>proxObs :: StdGen -&gt; Int -&gt; (Terreno,[Obstaculo]) -&gt; [Obstaculo]
proxObs seed l (t,lT) | l == length lT = lT
                      | otherwise      = proxObs proximoAleatorio l (t,[obst]++lT)
                    where listaObst = proximosObstaculosValidos l (t,lT)
                          obst      = listaObst !! (mod aleatorio (length listaObst))
                          (aleatorio,proximoAleatorio) = next seed
</pre><h2>Exemplos de utiliza&#231;&#227;o:</h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>proxObs (mkStdGen 75) 2 (Relva, [])
</code></strong>[Arvore,Nenhum]
</pre><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>proxObs (mkStdGen 0) 10 (Rio (-2),[])
</code></strong>[Nenhum,Tronco,Nenhum,Tronco,Nenhum,Nenhum,Tronco,Tronco,Tronco,Tronco]
</pre><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>proxObs (mkStdGen 27) 8 (Estrada 1,[])
</code></strong>[Carro,Nenhum,Carro,Nenhum,Nenhum,Nenhum,Carro,Nenhum]
</pre></div></div><div class="top"><p class="src"><a id="v:replace" class="def">replace</a> <a href="#v:replace" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a></td><td class="doc"><p>1&#186; argumento: obst&#225;culo</p></td></tr><tr><td class="src">-&gt; [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]</td><td class="doc"><p>2&#186; argumento: lista de obst&#225;culos</p></td></tr><tr><td class="src">-&gt; [Int]</td><td class="doc"><p>3&#186; argumento: lista de posi&#231;oes</p></td></tr><tr><td class="src">-&gt; [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]</td><td class="doc"><p>resultado: lista de obst&#225;culos com o obstaculo substituido</p></td></tr></table></div><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2022li1g007.html#v:replace" title="Tarefa2_2022li1g007">replace</a></code> tem como objetivo substituir uns obst&#225;culos numa lista de obst&#225;culos dada umas posi&#231;oes e dado o novo Obstaculo.</p><p>A fun&#231;&#227;o poderia ser definida da seguinte forma:</p><pre>replace :: Obstaculo -&gt; [Obstaculo] -&gt; [Int] -&gt; [Obstaculo]
replace _ [] _ = []
replace _ l [] = l
replace novoElemento l (posicao:t) = replace novoElemento (take posicao l ++ [novoElemento] ++ drop (posicao+1) l) t
</pre><h2>Exemplos de utiliza&#231;&#227;o:</h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>replace Nenhum [Nenhum,Arvore,Arvore,Nenhum,Arvore] [3]
</code></strong>[Nenhum,Arvore,Arvore,Nenhum,Arvore]
</pre></div></div><div class="top"><p class="src"><a id="v:proximasArvores" class="def">proximasArvores</a> <a href="#v:proximasArvores" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: StdGen</td><td class="doc"><p>1&#186; argumento: n&#250;mero aleat&#243;rio</p></td></tr><tr><td class="src">-&gt; [(<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>])]</td><td class="doc"><p>2&#186; argumento: lista da Relva criada com a Relva existente</p></td></tr><tr><td class="src">-&gt; [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]</td><td class="doc"><p>resultado: lista de obstaculos da Relva criada</p></td></tr></table></div><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2022li1g007.html#v:proximasArvores" title="Tarefa2_2022li1g007">proximasArvores</a></code> tem como objetivo ver em que posi&#231;oes existe Nenhum na Relva existente e com o auxilio da fun&#231;ao auxiliar <code>substituiRandom</code>
substituir alguns obst&#225;culos na Relva criada por Nenhum, de modo que sejam substituidos em algumas posi&#231;oes em que existe Nenhum na Relva existente.</p><p>A fun&#231;&#227;o poderia ser definida da seguinte forma:</p><pre>proximasArvores :: StdGen -&gt; [(Terreno,[Obstaculo])] -&gt; [Obstaculo]
proximasArvores seed [(Relva,obst1),(Relva,obst2)] = substituiRandom posicoes obst1
                                            where nenhum = elemIndices Nenhum obst2
                                                  posicoes = drop (mod (fst $ next seed) (length nenhum)) nenhum
</pre><h2>Exemplos de utiliza&#231;&#227;o:</h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>proximasArvores (mkStdGen 90) [(Relva,[Arvore,Arvore,Arvore,Arvore,Arvore,Nenhum]),(Relva,[Arvore,Nenhum,Nenhum,Nenhum,Arvore,Arvore])]
</code></strong>[Arvore,Arvore,Arvore,Nenhum,Arvore,Nenhum]
</pre></div></div><div class="top"><p class="src"><a id="v:proximosTerrenosValidos" class="def">proximosTerrenosValidos</a> <a href="#v:proximosTerrenosValidos" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="LI12223.html#t:Mapa" title="LI12223">Mapa</a></td><td class="doc"><p>argumento: um mapa</p></td></tr><tr><td class="src">-&gt; [<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>]</td><td class="doc"><p>resultado: lista de pr&#243;ximos terrenos v&#225;lidos</p></td></tr></table></div><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2022li1g007.html#v:proximosTerrenosValidos" title="Tarefa2_2022li1g007">proximosTerrenosValidos</a></code> recebe um mapa e gera a lista de terrenos poss&#237;veis de serem usados numa nova linha no topo do mapa gerado.</p><p>As restri&#231;&#245;es que esta imp&#245;em s&#227;o:</p><ul><li>N&#227;o pode haver num mapa mais que 4 rios seguidos</li><li>N&#227;o pode haver num mapa mais que 5 estradas seguidas</li><li>N&#227;o pode haver num mapa mais que 5 relvas seguidas</li></ul><p>Assim, por exemplo, quando ocorre numa lista 4 rios seguidos esta fun&#231;&#227;o retornar&#225; [Estrada 0,Relva] j&#225; que n&#227;o &#233; possivel ocorrer outro Rio.</p><p>A fun&#231;&#227;o poderia ser definida da seguinte forma:</p><pre>proximosTerrenosValidos :: Mapa -&gt; [Terreno]

proximosTerrenosValidos (Mapa _ []) = [Rio 0, Estrada 0, Relva]

proximosTerrenosValidos (Mapa _ ((Rio _,_):(Rio _,_):(Rio _,_):(Rio _,_):_))                               = [Estrada 0,Relva] 
proximosTerrenosValidos (Mapa _ ((Estrada _,_):(Estrada _,_):(Estrada _,_):(Estrada _,_):(Estrada _,_):_)) = [Rio 0,Relva]
proximosTerrenosValidos (Mapa _ ((Relva ,_):(Relva ,_):(Relva ,_):(Relva ,_):(Relva ,_):_))                = [Estrada 0,Rio 0]

proximosTerrenosValidos (Mapa _ l) = [Rio 0,Estrada 0,Relva]
</pre><h2>Exemplos de utiliza&#231;&#227;o:</h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>proximosTerrenosValidos (Mapa 2 [(Rio 2, [Nenhum,Tronco]),(Rio (-2),[Tronco,Nenhum]),(Rio 1, [Tronco,Nenhum]),(Rio (-2),[Tronco,Nenhum])])
</code></strong>[Estrada 0,Relva]
</pre><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>proximosTerrenosValidos (Mapa 2 [(Estrada 1,[Carro,Nenhum]),(Estrada (-1),[Carro,Nenhum]),(Estrada 1,[Nenhum,Carro]),(Estrada 1,[Nenhum,Carro]),(Estrada (-1),[Carro,Nenhum])])
</code></strong>[Rio 0,Relva]
</pre></div></div><div class="top"><p class="src"><a id="v:proximosObstaculosValidos" class="def">proximosObstaculosValidos</a> <a href="#v:proximosObstaculosValidos" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: Int</td><td class="doc"><p>1&#186; argumento: largura do mapa</p></td></tr><tr><td class="src">-&gt; (<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>])</td><td class="doc"><p>2&#186; argumento: um par de um terreno com uma lista de obst&#225;culos</p></td></tr><tr><td class="src">-&gt; [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]</td><td class="doc"><p>resultado: lista dos pr&#243;ximos obst&#225;culos v&#225;lidos</p></td></tr></table></div><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2022li1g007.html#v:proximosObstaculosValidos" title="Tarefa2_2022li1g007">proximosObstaculosValidos</a></code> gera uma lista de obst&#225;culos pass&#237;veis de serem utilizados numa dada linha do mapa.</p><p>Para isso, ela recebe um inteiro, correspondente &#224; largura do mapa, e um par de um terreno com uma lista de obst&#225;culos. 
Atrav&#233;s desses valores devolve uma lista com os pr&#243;ximos obst&#225;culos poss&#237;veis.
Esta imp&#245;em algumas restri&#231;&#245;es como:</p><ul><li>O pr&#243;ximo obst&#225;culo de um <strong>Rio</strong> pertence a <strong>[Nenhum, Tronco]</strong></li><li>O pr&#243;ximo obst&#225;culo de uma <strong>Estrada</strong> pertence a <strong>[Nenhum, Carro]</strong></li><li>O pr&#243;ximo obst&#225;culo de uma <strong>Relva</strong> pertence a <strong>[Nenhum, Arvore]</strong></li></ul><p>Mais restri&#231;&#245;es est&#227;o impostas pela fun&#231;&#227;o auxiliar <code><a href="Tarefa2_2022li1g007.html#v:auxObstaculosValidos" title="Tarefa2_2022li1g007">auxObstaculosValidos</a></code>.</p><p>A fun&#231;&#227;o poderia ser definida da seguinte forma:</p><pre>proximosObstaculosValidos :: Int -&gt; (Terreno, [Obstaculo]) -&gt; [Obstaculo]

proximosObstaculosValidos _ (Rio _, [])     = [Nenhum, Tronco]
proximosObstaculosValidos _ (Estrada _, []) = [Nenhum, Carro]
proximosObstaculosValidos _ (Relva, [])     = [Nenhum, Arvore]


proximosObstaculosValidos l (t, lT) = if l == length lT then []
                                      else auxObstaculosValidos l (t,lT)
</pre><h2>Exemplos de utiliza&#231;&#227;o:</h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>proximosObstaculosValidos 6 (Rio (-1), [Nenhum,Nenhum])
</code></strong>[Tronco]
</pre><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>proximosObstaculosValidos 6 (Estrada (-1), [Nenhum,Nenhum])
</code></strong>[Nenhum, Carro]
</pre></div></div><div class="top"><p class="src"><a id="v:auxObstaculosValidos" class="def">auxObstaculosValidos</a> <a href="#v:auxObstaculosValidos" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: Int</td><td class="doc"><p>1&#186; argumento: largura do mapa</p></td></tr><tr><td class="src">-&gt; (<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>])</td><td class="doc"><p>2&#186; argumento: um par de um terreno com uma lista de obst&#225;culos</p></td></tr><tr><td class="src">-&gt; [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]</td><td class="doc"><p>resultado: lista de obst&#225;culos pass&#237;veis de serem usados com algumas restri&#231;&#245;es</p></td></tr></table></div><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2022li1g007.html#v:auxObstaculosValidos" title="Tarefa2_2022li1g007">auxObstaculosValidos</a></code> &#233; uma fun&#231;&#227;o auxiliar da fun&#231;&#227;o <code><a href="Tarefa2_2022li1g007.html#v:proximosObstaculosValidos" title="Tarefa2_2022li1g007">proximosObstaculosValidos</a></code>.
Esta fun&#231;&#227;o filtra casos particulares da fun&#231;&#227;o <code><a href="Tarefa2_2022li1g007.html#v:proximosObstaculosValidos" title="Tarefa2_2022li1g007">proximosObstaculosValidos</a></code>.
Deste modo, esta filtra os casos em que:</p><ul><li>H&#225; numa lista 5 Troncos seguidos e devolve [Nenhum] j&#225; que n&#227;o podem haver mais do que 5 seguidos</li><li>H&#225; numa lista 3 Carros seguidos e devolve [Nenhum] j&#225; que n&#227;o podem haver mais do que 3 seguidos</li><li>Numa lista do terreno Rio, caso ela n&#227;o contenha Tronco, devolve [Tronco] </li><li>Numa lista em que ainda n&#227;o ocorre Nenhum e devolve [Nenhum]</li></ul><p>A fun&#231;&#227;o poderia ser definida da seguinte forma:</p><pre>auxObstaculosValidos :: Int -&gt; (Terreno, [Obstaculo]) -&gt; [Obstaculo]
auxObstaculosValidos _ (Rio _, (Tronco:Tronco:Tronco:Tronco:Tronco:_)) = [Nenhum]
auxObstaculosValidos _ (Estrada _, (Carro:Carro:Carro:_))              = [Nenhum]

auxObstaculosValidos _ (Rio _, lT) | not(elem Nenhum lT)                                        = [Nenhum]
                                   | not(elem Tronco lT)                                        = [Tronco]
                                   | head lT == last lT &amp;&amp; head lT == Tronco &amp;&amp; nElementos &gt;= 5 = [Nenhum]
                                   | otherwise                                                  = [Nenhum,Tronco]
                                   where nElementos = length hl + length (last tl)
                                         (hl:tl)    = group lT

auxObstaculosValidos l (Estrada _,lT) | length lT == 1 &amp;&amp; not (elem Nenhum lT)                    = [Nenhum]
                                      | head lT == last lT &amp;&amp; head lT == Carro &amp;&amp; nElementos &gt;= 3 = [Nenhum]
                                      | not (elem Nenhum lT) &amp;&amp; (l == (length lT - 1))            = [Nenhum]
                                      | otherwise                                                 = [Nenhum,Carro]
                                      where nElementos = length hl + length (last tl)
                                            (hl:tl)    = group lT

auxObstaculosValidos _ (Relva, lT) = if not(elem Nenhum lT) then [Nenhum] else [Arvore,Nenhum]
</pre><h2>Exemplo:</h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>auxObstaculosValidos 7 (Rio (-1), [Tronco,Tronco,Tronco,Tronco,Tronco,Nenhum])
</code></strong>[Nenhum]
</pre><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>auxObstaculosValidos 5 (Estrada (-1), [Carro,Carro,Nenhum,Carro])
</code></strong>[Nenhum]
</pre><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>auxObstaculosValidos 4 (Rio (-2), [Nenhum,Nenhum,Nenhum])
</code></strong>[Tronco]
</pre></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.26.0</p></div></body></html>