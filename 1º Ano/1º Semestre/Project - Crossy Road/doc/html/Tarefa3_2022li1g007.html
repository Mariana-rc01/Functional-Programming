<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Tarefa3_2022li1g007</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption empty">&nbsp;</span><ul class="links" id="page-menu"><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th valign="top">Copyright</th><td>Mariana Rocha Cristino &lt;a90817@alunos.uminho.pt&gt;<br />Ana Carolina Penha Cerqueira &lt;a104188@alunos.uminho.pt&gt;</td></tr><tr><th>Safe Haskell</th><td>Safe-Inferred</td></tr></table><p class="caption">Tarefa3_2022li1g007</p></div><div id="description"><p class="caption">Description</p><div class="doc"><p>M&#243;dulo para a realiza&#231;&#227;o da Tarefa 3 do projeto de LI1 em 2022/23.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><a href="#v:animaJogo">animaJogo</a> :: <a href="LI12223.html#t:Jogo" title="LI12223">Jogo</a> -&gt; <a href="LI12223.html#t:Jogada" title="LI12223">Jogada</a> -&gt; <a href="LI12223.html#t:Jogo" title="LI12223">Jogo</a></li><li class="src short"><a href="#v:moveJogador">moveJogador</a> :: <a href="LI12223.html#t:Jogador" title="LI12223">Jogador</a> -&gt; <a href="LI12223.html#t:Mapa" title="LI12223">Mapa</a> -&gt; <a href="LI12223.html#t:Jogada" title="LI12223">Jogada</a> -&gt; <a href="LI12223.html#t:Jogador" title="LI12223">Jogador</a></li><li class="src short"><a href="#v:moveObstaculo">moveObstaculo</a> :: [(<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>])] -&gt; <a href="LI12223.html#t:Jogada" title="LI12223">Jogada</a> -&gt; <a href="LI12223.html#t:Jogador" title="LI12223">Jogador</a> -&gt; [(<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>])]</li><li class="src short"><a href="#v:moveEstrada">moveEstrada</a> :: [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>] -&gt; Int -&gt; Int -&gt; [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]</li><li class="src short"><a href="#v:moveObstaculoAux">moveObstaculoAux</a> :: [(<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>])] -&gt; [(<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>])]</li><li class="src short"><a href="#v:animaJogadorTronco">animaJogadorTronco</a> :: <a href="LI12223.html#t:Jogo" title="LI12223">Jogo</a> -&gt; <a href="LI12223.html#t:Jogada" title="LI12223">Jogada</a> -&gt; <a href="LI12223.html#t:Jogo" title="LI12223">Jogo</a></li><li class="src short"><a href="#v:moveTronco">moveTronco</a> :: [(<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>])] -&gt; <a href="LI12223.html#t:Jogador" title="LI12223">Jogador</a> -&gt; [(<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>])]</li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><a id="v:animaJogo" class="def">animaJogo</a> <a href="#v:animaJogo" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="LI12223.html#t:Jogo" title="LI12223">Jogo</a></td><td class="doc"><p>1&#186; argumento: Jogo constitu&#237;do por um jogador e por um mapa</p></td></tr><tr><td class="src">-&gt; <a href="LI12223.html#t:Jogada" title="LI12223">Jogada</a></td><td class="doc"><p>2&#186; argumento: Jogada efetuada</p></td></tr><tr><td class="src">-&gt; <a href="LI12223.html#t:Jogo" title="LI12223">Jogo</a></td><td class="doc"><p>resultado: Jogo com o movimento do jogador e dos obst&#225;culos</p></td></tr></table></div><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa3_2022li1g007.html#v:animaJogo" title="Tarefa3_2022li1g007">animaJogo</a></code> movimenta os obst&#225;culos (consoante a sua velocidade associada) e a personagem, de acordo com 
a jogada fornecida e onde a personagem se encontra, com o aux&#237;lio das fun&#231;&#245;es <code><a href="Tarefa3_2022li1g007.html#v:moveObstaculo" title="Tarefa3_2022li1g007">moveObstaculo</a></code> e <code><a href="Tarefa3_2022li1g007.html#v:moveJogador" title="Tarefa3_2022li1g007">moveJogador</a></code>, respetivamente.</p><p>Assume-se que a personagem se encontra dentro de um mapa v&#225;lido.</p><p>A fun&#231;&#227;o poderia ser definida da seguinte forma:</p><pre>animaJogo :: Jogo -&gt; Jogada -&gt; Jogo
animaJogo jogo@(Jogo jogador (Mapa l lT)) jogada = Jogo (moveJogador jogo jogada) (Mapa l (moveObstaculo lT))
</pre><h2>Exemplos de utiliza&#231;&#227;o:</h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>animaJogo (Jogo (Jogador (2,2)) (Mapa 4 [(Rio 1,[Nenhum,Tronco,Nenhum,Tronco]),(Relva,[Nenhum,Nenhum,Nenhum,Nenhum]),(Estrada (-1),[Carro,Carro,Nenhum,Nenhum])])) Parado
</code></strong>Jogo (Jogador (2,2)) (Mapa 4 [(Rio 1,[Tronco,Nenhum,Tronco,Nenhum]),(Relva,[Nenhum,Nenhum,Nenhum,Nenhum]),(Estrada (-1),[Carro,Nenhum,Nenhum,Carro])])
</pre><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>animaJogo (Jogo (Jogador (1,0)) (Mapa 4 [(Rio 1,[Nenhum,Tronco,Nenhum,Tronco]),(Relva,[Nenhum,Nenhum,Nenhum,Nenhum]),(Estrada (-1),[Carro,Carro,Nenhum,Nenhum])])) Parado
</code></strong>Jogo (Jogador (2,0)) (Mapa 4 [(Rio 1,[Tronco,Nenhum,Tronco,Nenhum]),(Relva,[Nenhum,Nenhum,Nenhum,Nenhum]),(Estrada (-1),[Carro,Nenhum,Nenhum,Carro])])
</pre><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>animaJogo (Jogo (Jogador (1,0)) (Mapa 4 [(Rio 1,[Nenhum,Tronco,Nenhum,Tronco]),(Relva,[Nenhum,Nenhum,Nenhum,Nenhum]),(Estrada (-1),[Carro,Carro,Nenhum,Nenhum])])) (Move Baixo)
</code></strong>Jogo (Jogador (1,1)) (Mapa 4 [(Rio 1,[Tronco,Nenhum,Tronco,Nenhum]),(Relva,[Nenhum,Nenhum,Nenhum,Nenhum]),(Estrada (-1),[Carro,Nenhum,Nenhum,Carro])])
</pre><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>animaJogo (Jogo (Jogador (3,2)) (Mapa 4 [(Relva,[Nenhum,Arvore,Nenhum,Nenhum]),(Estrada (-1),[Carro,Nenhum,Carro,Carro]),(Rio 2,[Tronco,Tronco,Tronco,Nenhum])])) (Move Cima)
</code></strong>Jogo (Jogador (3,1)) (Mapa 4 [(Relva,[Nenhum,Arvore,Nenhum,Nenhum]),(Estrada (-1),[Nenhum,Carro,Carro,Carro]),(Rio 2,[Tronco,Nenhum,Tronco,Tronco])])
</pre></div></div><div class="top"><p class="src"><a id="v:moveJogador" class="def">moveJogador</a> <a href="#v:moveJogador" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="LI12223.html#t:Jogador" title="LI12223">Jogador</a></td><td class="doc"><p>1&#186; argumento: Jogador que se vai mover</p></td></tr><tr><td class="src">-&gt; <a href="LI12223.html#t:Mapa" title="LI12223">Mapa</a></td><td class="doc"><p>2&#186; argumento: Mapa em que o Jogador se encontra</p></td></tr><tr><td class="src">-&gt; <a href="LI12223.html#t:Jogada" title="LI12223">Jogada</a></td><td class="doc"><p>3&#186; argumento: Jogada efetuada</p></td></tr><tr><td class="src">-&gt; <a href="LI12223.html#t:Jogador" title="LI12223">Jogador</a></td><td class="doc"><p>resultado: Jogo com o movimento do jogador</p></td></tr></table></div><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa3_2022li1g007.html#v:moveJogador" title="Tarefa3_2022li1g007">moveJogador</a></code> recebe um Jogador, o Mapa em que este se encontra e uma Jogada e retorna um Jogador com a sua posi&#231;&#227;o ap&#243;s a jogada.</p><p>Desta forma, caso a jogada seja <strong>Parado</strong> a sua posi&#231;&#227;o final ser&#225; a mesma, caso o Jogador n&#227;o se encontre em cima de 
um Tronco, caso contr&#225;rio, este move-se consoante a velocidade do Rio.</p><p>Caso esteja definido um <strong>movimento</strong> na Jogada, a posi&#231;&#227;o final do Jogador ter&#225; em conta quando o Jogador:</p><ul><li>Se encontra em cima de um Tronco</li><li>Tenta escapar do mapa atrav&#233;s dos seus movimentos</li><li>Tenta ir para a mesma posi&#231;&#227;o que uma Arvore</li></ul><p>Note-se que, caso o Jogador se encontre em cima de um Tronco e pretenda ir para avan&#231;ar e se deparar com uma Arvore, ent&#227;o
o Jogador move-se com o Tronco e n&#227;o consegue avan&#231;ar para a Relva.
Caso o Jogador esteja em cima de um Tronco e pretenda avan&#231;ar para outro Terreno, a sua coordenada horizontal n&#227;o &#233; 
afetada pela velocidade do Rio em que se encontra.</p><p>A fun&#231;&#227;o poderia ser definida da seguinte forma:</p><pre>moveJogador :: Jogo -&gt; Mapa -&gt; Jogada -&gt; Jogador

moveJogador (Jogador (x,y)) (Mapa l lT) Parado | ((snd(lT !! y)) !! x) == Tronco = Jogador (x+velocidade,y)
                                               | otherwise                       = Jogador (x,y)
                                               where velocidade = v(fst(lT !! y))
                                                     v (Rio x)  = x

moveJogador (Jogador (x,y)) (Mapa l lT) move | obstaculo == Tronco &amp;&amp; move == Move Esquerda                                                   = Jogador (x+velocidade-1,y)
                                             | obstaculo == Tronco &amp;&amp; move == Move Direita                                                    = Jogador (x+velocidade+1,y)
                                             | obstaculo == Tronco &amp;&amp; (move == Move Cima  &amp;&amp; (y == 0 || ((snd(lT !! (y-1))) !! x) == Arvore)) = Jogador (x+velocidade,y)
                                             | obstaculo == Tronco &amp;&amp; (move == Move Baixo &amp;&amp; ((snd(lT !! (y+1))) !! x) == Arvore)             = Jogador (x+velocidade,y)
                                             where velocidade = v(fst(lT !! y))
                                                   v (Rio x)  = x
                                                   obstaculo = ((snd(lT !! y)) !! x)

moveJogador j<code>(Jogador (x,y)) (Mapa l lT) move | move == Move Cima     &amp;&amp; y /= 0            &amp;&amp; ((snd(lT !! (y-1))) !! x) == Arvore = j
                                               | move == Move Baixo    &amp;&amp; y &lt; length lT - 1 &amp;&amp; ((snd(lT !! (y+1))) !! x) == Arvore = j
                                               | move == Move Esquerda &amp;&amp; x /= 0            &amp;&amp; ((snd(lT !! y)) !! (x-1)) == Arvore = j
                                               | move == Move Direita  &amp;&amp; x /= l-1          &amp;&amp; ((snd(lT !! y)) !! (x+1)) == Arvore = j  

moveJogador j</code>(Jogador (x,y)) (Mapa l lT) move | y == 0             &amp;&amp; move == Move Cima     = j
                                               | x == 0             &amp;&amp; move == Move Esquerda = j
                                               | x == l-1           &amp;&amp; move == Move Direita  = j
                                               | y == length lT - 1 &amp;&amp; move == Move Baixo    = j

moveJogador (Jogador (x,y)) _ move = case move of Move Cima     -&gt; Jogador (x,y-1)
                                                  Move Baixo    -&gt; Jogador (x,y+1)
                                                  Move Esquerda -&gt; Jogador (x-1,y)
                                                  Move Direita  -&gt; Jogador (x+1,y)
</pre><h2>Exemplos de utiliza&#231;&#227;o:</h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>moveJogador (Jogo (Jogador (1,0)) (Mapa 2 [(Rio 2, [Nenhum,Tronco]),(Rio (-2),[Tronco,Nenhum]),(Rio 1, [Tronco,Nenhum]),(Rio (-2),[Tronco,Nenhum]),(Rio 1, [Tronco,Nenhum]),(Rio 2, [Nenhum, Tronco])])) Parado
</code></strong>Jogador (3,0)
</pre><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>moveJogador (Jogo (Jogador (2,2)) (Mapa 4 [(Relva,[Nenhum,Arvore,Nenhum,Nenhum]),(Relva,[Nenhum,Nenhum,Arvore,Nenhum]),(Rio 2,[Tronco,Tronco,Tronco,Nenhum])])) (Move Cima)
</code></strong>Jogador (4,2)
</pre><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>moveJogador (Jogo (Jogador (2,2)) (Mapa 4 [(Relva,[Nenhum,Arvore,Nenhum,Nenhum]),(Relva,[Nenhum,Arvore,Arvore,Nenhum]),(Rio 2,[Tronco,Tronco,Tronco,Nenhum])])) (Move Esquerda)
</code></strong>Jogador (3,2)
</pre></div></div><div class="top"><p class="src"><a id="v:moveObstaculo" class="def">moveObstaculo</a> <a href="#v:moveObstaculo" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: [(<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>])]</td><td class="doc"><p>1&#186; argumento: lista de pares de terrenos e lista de obst&#225;culos associada a cada terreno</p></td></tr><tr><td class="src">-&gt; <a href="LI12223.html#t:Jogada" title="LI12223">Jogada</a></td><td class="doc"><p>2&#186; argumento: Jogada do Jogador</p></td></tr><tr><td class="src">-&gt; <a href="LI12223.html#t:Jogador" title="LI12223">Jogador</a></td><td class="doc"><p>3&#186; argumento: Jogador        </p></td></tr><tr><td class="src">-&gt; [(<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>])]</td><td class="doc"><p>resultado: lista de pares de terrenos e lista de obst&#225;culos movidos consoante a velocidade associada</p></td></tr></table></div><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa3_2022li1g007.html#v:moveObstaculo" title="Tarefa3_2022li1g007">moveObstaculo</a></code> tem como objetivo mover os obst&#225;culos consoante a velocidade associada.</p><p>Desta forma, caso nos encontremos na <strong>Relva</strong>, os obst&#225;culos mant&#234;m-se na mesma posi&#231;&#227;o, caso se encontrem na <strong>Estrada</strong> ou no <strong>Rio</strong>,
os obst&#225;culos movem-se.</p><p>&#201; tamb&#233;m necess&#225;rio ter em aten&#231;&#227;o caso o Jogador se encontre ou se desloce para uma Estrada que este pode ser atropelado tendo em conta o movimento do mesmo.
De modo que, averigua-se qual o movimento do Jogador e caso este se mova para Cima ou para Baixo, verifica-se se o terreno para onde este se move &#233; uma Estrada.
Caso contr&#225;rio, verifica-se se o Jogador se encontra numa Estrada.</p><p>Caso o Jogador n&#227;o se encontre numa Estrada, ent&#227;o todos os obst&#225;culos se ir&#227;o mover sem qualquer restri&#231;&#227;o com o aux&#237;lio da fun&#231;&#227;o <code><a href="Tarefa3_2022li1g007.html#v:moveObstaculoAux" title="Tarefa3_2022li1g007">moveObstaculoAux</a></code>.</p><p>Caso o Jogador se encontre ou se desloce para uma Estrada, esta tem os obst&#225;culos a serem movidos com o aux&#237;lio da fun&#231;&#227;o auxiliar <code><a href="Tarefa3_2022li1g007.html#v:moveEstrada" title="Tarefa3_2022li1g007">moveEstrada</a></code>.
Os restantes terrenos t&#234;m os seus obst&#225;culos a moverem-se sem qualquer restri&#231;&#227;o, movendo-se com o aux&#237;lio da fun&#231;&#227;o <code><a href="Tarefa3_2022li1g007.html#v:moveObstaculoAux" title="Tarefa3_2022li1g007">moveObstaculoAux</a></code>.</p><p>Para ser poss&#237;vel mover em separado os obst&#225;culos da Estrada que o Jogador se localiza, &#233; usada a fun&#231;&#227;o splitAt, onde esta separa os terrenos, de modo que o &#250;ltimo Terreno da
primeira parte do tuplo seja onde o Jogador se encontra, os restantes elementos da primeira parte do tuplo s&#227;o os Terrenos que se encontram &#224; frente do Jogador e a segunda parte do tuplo s&#227;o
os Terrenos que se encontram atr&#225;s do Jogador.</p><p>A fun&#231;&#227;o poderia ser definida da seguinte forma:</p><pre>moveObstaculo :: [(Terreno,[Obstaculo])] -&gt; Jogada -&gt; Jogador -&gt; [(Terreno,[Obstaculo])]
moveObstaculo lT@((t,obs):ts) m (Jogador (x,y)) 
        | m == Move Direita  &amp;&amp; (passaString (fst(lT !! y)))     == <a href="Estrada.html">Estrada</a> = moveObstaculoAux (frente $ splitAt (y+1) lT) ++ [(Estrada v     , moveEstrada (jogador $ splitAt (y+1) lT) v (x+1))]  ++ moveObstaculoAux (tras $ splitAt (y+1) lT)

        | m == Move Esquerda &amp;&amp; (passaString (fst(lT !! y)))     == <a href="Estrada.html">Estrada</a> = moveObstaculoAux (frente $ splitAt (y+1) lT) ++ [(Estrada v     , moveEstrada (jogador $ splitAt (y+1) lT) v (x-1))]  ++ moveObstaculoAux (tras $ splitAt (y+1) lT)

        | m == Parado        &amp;&amp; (passaString (fst(lT !! y)))     == <a href="Estrada.html">Estrada</a> = moveObstaculoAux (frente $ splitAt (y+1) lT) ++ [(Estrada v     , moveEstrada (jogador $ splitAt (y+1) lT) v x)]      ++ moveObstaculoAux (tras $ splitAt (y+1) lT)

        | y &gt; 0 &amp;&amp; m == Move Cima &amp;&amp; (passaString (fst(lT !! (y-1)))) == <a href="Estrada.html">Estrada</a> = moveObstaculoAux (frente $ splitAt (y+1) lT) ++ [(Estrada v     , moveEstrada (jogador $ splitAt (y+1) lT) v x)]  ++ moveObstaculoAux (tras $ splitAt (y+1) lT)

        | y == 0 &amp;&amp; m == Move Cima &amp;&amp; (passaString (fst(lT !! y))) == <a href="Estrada.html">Estrada</a>    = moveObstaculoAux (frente $ splitAt y lT)     ++ [(Estrada vCima , moveEstrada (jogador $ splitAt y lT) vCima x)]  ++ moveObstaculoAux (tras $ splitAt y lT)

        | y &lt; length lT - 1  &amp;&amp; m == Move Baixo &amp;&amp; (passaString (fst(lT !! (y+1)))) == <a href="Estrada.html">Estrada</a> = moveObstaculoAux (frente $ splitAt (y+2) lT) ++ [(Estrada vBaixo, moveEstrada (jogador $ splitAt (y+2) lT) vBaixo x)] ++ moveObstaculoAux (tras $ splitAt (y+2) lT)

        | y == length lT - 1 &amp;&amp; m == Move Baixo &amp;&amp; (passaString (fst(lT !! y)))     == <a href="Estrada.html">Estrada</a> = moveObstaculoAux (frente $ splitAt (y+1) lT) ++ [(Estrada v     , moveEstrada (jogador $ splitAt (y+1) lT) v x)]      ++ moveObstaculoAux (tras $ splitAt (y+1) lT)

        | otherwise = moveObstaculoAux lT

     where v = velocidade (fst(lT !! y))
           vCima = velocidade (fst (lT !! (y-1)))
           vBaixo = velocidade (fst (lT !! (y+1)))
           velocidade (Estrada x)  = x
           passaString :: Terreno -&gt; String
           passaString t = case t of Estrada _ -&gt; <a href="Estrada.html">Estrada</a>
                                     Rio _     -&gt; <a href="Rio.html">Rio</a>    
                                     Relva     -&gt; <a href="Relva.html">Relva</a> 
           frente x  = init $ fst x
           tras x    = snd x
           jogador x = snd $ last $ fst x
</pre><h2>Exemplos de utiliza&#231;&#227;o:</h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>moveObstaculo [(Estrada 2,[Carro,Nenhum,Carro,Nenhum,Nenhum]),(Relva,[Arvore,Nenhum,Nenhum,Nenhum,Nenhum]),(Estrada 2,[Carro,Nenhum,Nenhum,Carro,Nenhum])] (Move Baixo) (Jogador (1,1))
</code></strong>[(Estrada 2,[Nenhum,Nenhum,Carro,Nenhum,Carro]),(Relva,[Arvore,Nenhum,Nenhum,Nenhum,Nenhum]),(Estrada 2,[Nenhum,Carro,Nenhum,Nenhum,Carro])]
</pre><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>moveObstaculo [(Estrada 1,[Carro,Nenhum,Carro,Nenhum,Nenhum]),(Relva,[Arvore,Nenhum,Nenhum,Nenhum,Nenhum])] (Move Cima) (Jogador (1,1))
</code></strong>[(Estrada 1,[Nenhum,Carro,Nenhum,Carro,Nenhum]),(Relva,[Arvore,Nenhum,Nenhum,Nenhum,Nenhum])]
</pre><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>moveObstaculo [(Estrada 1,[Carro,Nenhum,Carro,Nenhum,Nenhum]),(Relva,[Arvore,Nenhum,Nenhum,Nenhum,Nenhum])] (Move Esquerda) (Jogador (1,0))
</code></strong>[(Estrada 1,[Carro,Nenhum,Carro,Nenhum,Nenhum]),(Relva,[Arvore,Nenhum,Nenhum,Nenhum,Nenhum])]
</pre></div></div><div class="top"><p class="src"><a id="v:moveEstrada" class="def">moveEstrada</a> <a href="#v:moveEstrada" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]</td><td class="doc"><p>1&#186; argumento: lista de obst&#225;culos</p></td></tr><tr><td class="src">-&gt; Int</td><td class="doc"><p>2&#186; argumento: velocidade dos obst&#225;culos</p></td></tr><tr><td class="src">-&gt; Int</td><td class="doc"><p>3&#186; argumento: posi&#231;&#227;o do jogador no terreno</p></td></tr><tr><td class="src">-&gt; [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]</td><td class="doc"><p>resultado: lista de obst&#225;culos movidos consoante a velocidade associada</p></td></tr></table></div><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa3_2022li1g007.html#v:moveEstrada" title="Tarefa3_2022li1g007">moveEstrada</a></code> tem como objetivo mover os obst&#225;culos consoante a velocidade associada tendo em conta onde o Jogador se encontra.</p><p>Caso um Carro esteja na posi&#231;&#227;o onde o Jogador se encontra, ent&#227;o os obst&#225;culos param de se mexer, pois o jogador &#233; atropelado durante o movimento do carro,
correspondendo ao estado do mapa no momento em que o jogador perdeu.</p><p>Caso contr&#225;rio, os obst&#225;culos movem-se consoante a sua velocidade.</p><p>A fun&#231;&#227;o poderia ser definida da seguinte forma:</p><pre>moveEstrada :: [Obstaculo] -&gt; Int -&gt; Int -&gt; [Obstaculo]
moveEstrada l 0 _ = l
moveEstrada l v x | v &gt; 0 &amp;&amp; (l !! x) /= Carro = moveEstrada (last l: init l) (v-1) x
                  | v &lt; 0 &amp;&amp; (l !! x) /= Carro = moveEstrada (tail l ++ [head l]) (v+1) x
                  | otherwise = l
</pre><h2>Exemplos de utiliza&#231;&#227;o:</h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>moveEstrada [Carro,Carro,Nenhum,Nenhum] 2 2
</code></strong>[Nenhum,Carro,Carro,Nenhum]
</pre><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>moveEstrada [Carro,Carro,Nenhum,Nenhum,Nenhum] 2 4
</code></strong>[Nenhum,Nenhum,Carro,Carro,Nenhum]
</pre></div></div><div class="top"><p class="src"><a id="v:moveObstaculoAux" class="def">moveObstaculoAux</a> <a href="#v:moveObstaculoAux" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: [(<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>])]</td><td class="doc"><p>argumento: lista de pares de terrenos e lista de obst&#225;culos associada a cada terreno                                      </p></td></tr><tr><td class="src">-&gt; [(<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>])]</td><td class="doc"><p>resultado: lista de pares de terrenos e lista de obst&#225;culos movidos consoante a velocidade associada</p></td></tr></table></div><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa3_2022li1g007.html#v:moveObstaculoAux" title="Tarefa3_2022li1g007">moveObstaculoAux</a></code> tem como objetivo mover os obst&#225;culos consoante a velocidade associada.</p><p>Desta forma, caso nos encontremos na <strong>Relva</strong>, os obst&#225;culos mant&#234;m-se na mesma posi&#231;&#227;o, caso se encontrem na <strong>Estrada</strong> ou no <strong>Rio</strong>,
os obst&#225;culos movem-se.</p><p>Para que seja poss&#237;vel mover os obst&#225;culos, &#233; necess&#225;rio ter em conta que os obst&#225;culos devem se mover |v| unidades na dire&#231;&#227;o 
determinada. Assim, caso a velocidade seja <strong>positiva</strong>, os obst&#225;culos devem-se mover <strong>da</strong> <strong>esquerda</strong> <strong>para</strong> <strong>a</strong> <strong>direita</strong> |v| unidades,
caso seja <strong>negativa</strong>, devem-se mover <strong>da</strong> <strong>direita</strong> <strong>para</strong> <strong>a</strong> <strong>esquerda</strong> |v| unidades.</p><p>A fun&#231;&#227;o poderia ser definida da seguinte forma:</p><pre>moveObstaculoAux :: [(Terreno,[Obstaculo])] -&gt; [(Terreno,[Obstaculo])]
moveObstaculoAux [] = []
moveObstaculoAux ((t,l):ts) = case t of Relva     -&gt; (Relva,l):moveObstaculoAux ts
                                        Rio v     -&gt; (Rio v, (auxMove l v)):moveObstaculoAux ts
                                        Estrada v -&gt; (Estrada v, (auxMove l v)):moveObstaculoAux ts
                    where auxMove :: [Obstaculo] -&gt; Int -&gt; [Obstaculo]
                          auxMove l 0 = l
                          auxMove l v | v &gt; 0 = auxMove (last l: init l) (v-1)
                                      | v &lt; 0 = auxMove (tail l ++ [head l]) (v+1)
</pre><h2>Exemplos de utiliza&#231;&#227;o:</h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>moveObstaculoAux [(Rio 1,[Nenhum,Tronco,Nenhum,Tronco]),(Relva,[Nenhum,Nenhum,Nenhum,Nenhum]),(Estrada (-2),[Carro,Carro,Nenhum,Nenhum])]
</code></strong>[(Rio 1,[Tronco,Nenhum,Tronco,Nenhum]),(Relva,[Nenhum,Nenhum,Nenhum,Nenhum]),(Estrada (-2),[Nenhum,Nenhum,Carro,Carro])]
</pre><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>moveObstaculoAux [(Rio 3,[Nenhum,Tronco,Nenhum,Tronco]),(Relva,[Nenhum,Nenhum,Nenhum,Nenhum]),(Estrada (-4),[Carro,Carro,Nenhum,Nenhum])]
</code></strong>[(Rio 3,[Tronco,Nenhum,Tronco,Nenhum]),(Relva,[Nenhum,Nenhum,Nenhum,Nenhum]),(Estrada (-4),[Carro,Carro,Nenhum,Nenhum])]
</pre></div></div><div class="top"><p class="src"><a id="v:animaJogadorTronco" class="def">animaJogadorTronco</a> <a href="#v:animaJogadorTronco" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="LI12223.html#t:Jogo" title="LI12223">Jogo</a></td><td class="doc"><p>1&#186; argumento: Jogo constitu&#237;do por um jogador e por um mapa</p></td></tr><tr><td class="src">-&gt; <a href="LI12223.html#t:Jogada" title="LI12223">Jogada</a></td><td class="doc"><p>2&#186; argumento: Jogada efetuada</p></td></tr><tr><td class="src">-&gt; <a href="LI12223.html#t:Jogo" title="LI12223">Jogo</a></td><td class="doc"><p>resultado: Jogo com o movimento do jogador e dos obst&#225;culos</p></td></tr></table></div><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa3_2022li1g007.html#v:animaJogadorTronco" title="Tarefa3_2022li1g007">animaJogadorTronco</a></code> move a personagem, de acordo com 
a jogada fornecida e onde a personagem se encontra, com o aux&#237;lio da fun&#231;&#227;o <code><a href="Tarefa3_2022li1g007.html#v:moveJogador" title="Tarefa3_2022li1g007">moveJogador</a></code> e, 
caso o jogador se encontre num rio, move apenas os Troncos desse rio.</p><p>Assume-se que a personagem se encontra dentro de um mapa v&#225;lido.</p><p>A fun&#231;&#227;o poderia ser definida da seguinte forma:</p><pre>animaJogadorTronco :: Jogo -&gt; Jogada -&gt; Jogo
animaJogadorTronco (Jogo jogador mapa@(Mapa l lT)) jogada = Jogo (moveJogador jogador mapa jogada) (Mapa l (moveTronco lT jogador))
</pre><h2>Exemplos de utiliza&#231;&#227;o:</h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>animaJogadorTronco (Jogo (Jogador (2,2)) (Mapa 4 [(Rio 1,[Nenhum,Tronco,Nenhum,Tronco]),(Relva,[Nenhum,Nenhum,Nenhum,Nenhum]),(Estrada (-1),[Carro,Carro,Nenhum,Nenhum])])) Parado
</code></strong>Jogo (Jogador (2,2)) (Mapa 4 [(Rio 1,[Nenhum,Tronco,Nenhum,Tronco]),(Relva,[Nenhum,Nenhum,Nenhum,Nenhum]),(Estrada (-1),[Carro,Carro,Nenhum,Nenhum])])
</pre><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>animaJogo (Jogo (Jogador (1,0)) (Mapa 4 [(Rio 1,[Nenhum,Tronco,Nenhum,Tronco]),(Relva,[Nenhum,Nenhum,Nenhum,Nenhum]),(Estrada (-1),[Carro,Carro,Nenhum,Nenhum])])) Parado
</code></strong>Jogo (Jogador (2,0)) (Mapa 4 [(Rio 1,[Tronco,Nenhum,Tronco,Nenhum]),(Relva,[Nenhum,Nenhum,Nenhum,Nenhum]),(Estrada (-1),[Carro,Nenhum,Nenhum,Carro])])
</pre><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>animaJogadorTronco (Jogo (Jogador (1,0)) (Mapa 4 [(Rio 1,[Nenhum,Tronco,Nenhum,Tronco]),(Relva,[Nenhum,Nenhum,Nenhum,Nenhum]),(Estrada (-1),[Carro,Carro,Nenhum,Nenhum])])) Parado
</code></strong>Jogo (Jogador (2,0)) (Mapa 4 [(Rio 1,[Tronco,Nenhum,Tronco,Nenhum]),(Relva,[Nenhum,Nenhum,Nenhum,Nenhum]),(Estrada (-1),[Carro,Carro,Nenhum,Nenhum])])
</pre></div></div><div class="top"><p class="src"><a id="v:moveTronco" class="def">moveTronco</a> <a href="#v:moveTronco" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: [(<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>])]</td><td class="doc"><p>1&#186; argumento: lista de pares de terrenos e lista de obst&#225;culos associada a cada terreno</p></td></tr><tr><td class="src">-&gt; <a href="LI12223.html#t:Jogador" title="LI12223">Jogador</a></td><td class="doc"><p>2&#186; argumento: Jogador        </p></td></tr><tr><td class="src">-&gt; [(<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>])]</td><td class="doc"><p>resultado: lista de pares de terrenos e lista de obst&#225;culos movidos consoante a velocidade associada</p></td></tr></table></div><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa3_2022li1g007.html#v:moveTronco" title="Tarefa3_2022li1g007">moveTronco</a></code> tem como objetivo mover os Troncos de um certo Rio, caso o Jogador se encontre nesse Rio.</p><p>Desta forma, caso nos encontremos na <strong>Relva</strong> ou na <strong>Estrada</strong>, os obst&#225;culos mant&#234;m-se na mesma posi&#231;&#227;o, caso se encontrem no <strong>Rio</strong>,
os obst&#225;culos movem-se com o aux&#237;lio da fun&#231;&#227;o <code><a href="Tarefa3_2022li1g007.html#v:moveObstaculoAux" title="Tarefa3_2022li1g007">moveObstaculoAux</a></code>.</p><p>A fun&#231;&#227;o poderia ser definida da seguinte forma:</p><pre>moveTronco :: [(Terreno,[Obstaculo])] -&gt; Jogador -&gt; [(Terreno,[Obstaculo])]
moveTronco lT (Jogador (x,y)) 
        | (passaString (fst(lT !! y))) == <a href="Rio.html">Rio</a> = (frente $ splitAt (y+1) lT) ++ moveObstaculoAux [(Rio v, jogador $ splitAt (y+1) lT)]  ++ (tras $ splitAt (y+1) lT)
        | (passaString (fst(lT !! y))) == <a href="Rio.html">Rio</a> = (frente $ splitAt (y+1) lT) ++ moveObstaculoAux [(Rio v, jogador $ splitAt (y+1) lT)]  ++ (tras $ splitAt (y+1) lT)
        | otherwise = lT
     where v = velocidade (fst(lT !! y))
           velocidade (Rio x)  = x
           passaString :: Terreno -&gt; String
           passaString t = case t of Estrada _ -&gt; <a href="Estrada.html">Estrada</a>
                                     Rio _     -&gt; <a href="Rio.html">Rio</a>    
                                     Relva     -&gt; <a href="Relva.html">Relva</a> 
           frente x  = init $ fst x
           tras x    = snd x
           jogador x = snd $ last $ fst x
</pre><h2>Exemplos de utiliza&#231;&#227;o:</h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>moveTronco [(Rio 1,[Nenhum,Tronco,Nenhum,Tronco]),(Relva,[Nenhum,Nenhum,Nenhum,Nenhum]),(Estrada (-1),[Carro,Carro,Nenhum,Nenhum])] (Jogador (1,0))
</code></strong>[(Rio 1,[Tronco,Nenhum,Tronco,Nenhum]),(Relva,[Nenhum,Nenhum,Nenhum,Nenhum]),(Estrada (-1),[Carro,Carro,Nenhum,Nenhum])]
</pre><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>moveTronco [(Rio 1,[Nenhum,Tronco,Nenhum,Tronco]),(Relva,[Nenhum,Nenhum,Nenhum,Nenhum]),(Estrada (-1),[Carro,Carro,Nenhum,Nenhum])] (Jogador (1,1))
</code></strong>[(Rio 1,[Nenhum,Tronco,Nenhum,Tronco]),(Relva,[Nenhum,Nenhum,Nenhum,Nenhum]),(Estrada (-1),[Carro,Carro,Nenhum,Nenhum])]
</pre></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.26.0</p></div></body></html>